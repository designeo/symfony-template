{% set route = app.request.get('_route') %}
{% set route_params = app.request.get('_route_params') | merge(filter) %}
{% import 'AppBundle:Grid:paging.html.twig' as paginator %}

<div class="grid">
    <form method="get" class="grid-filter">
        <div class="grid_header"></div>
        <div class="grid_body">
            <table class="table responsive table-hover">
                <thead class="title">
                    <tr>
                        <th><a class="order" href="{{ path(route, route_params | merge({ 'sortBy': 'U.lastName' })) }}">{{ 'admin.users.entity.name'|trans }}</a></th>
                        <th><a class="order" href="{{ path(route, route_params | merge({ 'sortBy': 'U.email' })) }}">{{ 'admin.users.entity.email'|trans }}</a></th>
                        <th><a class="order" href="{{ path(route, route_params | merge({ 'sortBy': 'U.roles' })) }}">{{ 'admin.users.entity.role'|trans }}</a></th>
                        <th><a class="order" href="{{ path(route, route_params | merge({ 'sortBy': 'U.enabled' })) }}">{{ 'admin.users.entity.enabled'|trans }}</a></th>
                        {#<th><a class="order" href="{{ path(route, route_params | merge({ 'sortBy': 'U.lastLogin' })) }}">{{ 'admin.users.entity.lastLogin'|trans }}</a></th>#}
                        <th class="text-right">{{ 'admin.global.action'|trans }}</th>
                    </tr>
                </thead>
                <thead class="filters">
                    <tr>
                        <th>
                            <input name="name" type="text" value="{{ filter.name }}" class="send-form-on-enter" placeholder="{{ 'admin.global.filter'|trans }}" />
                        </th>
                        <th>
                            <input name="email" type="text" value="{{ filter.email }}" class="send-form-on-enter" placeholder="{{ 'admin.global.filter'|trans }}" />
                        </th>
                        <th>
                            <select name="role" class="send-form-on-change">
                                <option value="">-- {{ 'admin.global.choose'|trans }} ---</option>
                                {% for key, role in filterData.roles %}
                                    <option value="{{ key }}" {% if filter.role == key %}selected="selected"{% endif %}>{{ role }}</option>
                                {%  endfor %}
                            </select>
                        </th>
                        <th>
                            <select name="enabled" class="send-form-on-change">
                                <option value="">-- {{ 'admin.global.choose'|trans }} ---</option>
                                <option value="1" {% if filter.enabled == '1' %}selected="selected"{% endif %}>{{ 'admin.global.yes'|trans }}</option>
                                <option value="0" {% if filter.enabled == '0' %}selected="selected"{% endif %}>{{ 'admin.global.no'|trans }}</option>
                            </select>
                        </th>
                        {#<th></th>#}
                        <th class="last-column functions">
                            <button class="btn-neutral btn btn-sm" name="filter" type="submit"><span class="fa fa-check"></span></button>
                            <a href="{{ url('admin_user_index') }}" class="btn-neutral btn btn-sm"><span class="fa fa-times"></span></a>
                        </th>
                    </tr>
                </thead>

                {% for data_item in data %}
                <tbody>
                    <tr class="grid-row-cells even">
                        <td class="grid-column-name">{{ data_item.getFullName }}</td>
                        <td class="grid-column-name">{{ data_item.email }}</td>
                        <td class="grid-column-name">{{ data_item.userRoleName }}</td>
                        <td class="grid-column-name">{{ data_item.enabled|renderBool }}</td>
                        <td class="text-right functions">
                            <a href="{{ url('admin_user_detail', {'id': data_item.id}) }}" class="btn btn-secondary"><span class="glyphicon glyphicon-th"></span></a>
                            <a href="{{ url('admin_user_edit', {'id': data_item.id}) }}" class="btn btn-secondary"><span class="glyphicon glyphicon-pencil"></span></a>
                            <a href="{{ url('admin_user_remove', {'id': data_item.id}) }}" class="btn btn-primary" data-method="DELETE" data-confirm="{{ 'admin.users.messages.confirmDelete'|trans }}"><span class="glyphicon glyphicon-trash"></span></a>
                        </td>

                    </tr>
                {%  endfor %}
                </tbody>
            </table>
        </div>
    </form>
</div>

<div class="row">
    <div class="col-md-10">
        {% block pagination %}
            {% if data|length > 0 %}
                {{ paginator.nav(page, max_page) }}
            {% endif %}
        {% endblock pagination %}
    </div>
</div>